# MoClo Viewer V3 â€” Application Index

Reference document for the MoClo Genome Viewer V3 application.

## Architecture

- **Framework**: Vite + React 19 + TypeScript
- **Visualization**: Plotly.js (interactive charts), HTML Canvas (genome tracks)
- **Data**: Pre-computed JSON bundles from `pipeline_v2.py`
- **Path**: `experiments/EXP_001/moclo-viewer-v3/`

## Data Files (`public/`)

| File | Description |
|------|-------------|
| `data_bundle_v2.json` | All tiles, groups, primers, overhangs, domestication status |
| `gene_products.json` | 4300 genes with product, category, and KEGG pathways |
| `cds_regions.json` | CDS coordinates from GenBank |
| `mutations.json` | Silent mutations for BsaI domestication |
| `genome_seq.txt` | Full MG1655 genome sequence |

## Key Components (`src/components/`)

| Component | Purpose |
|-----------|---------|
| `GenomeOverview.tsx` | Full genome canvas with group/tile tracks |
| `GroupDetail.tsx` | Lvl1 assembly view with construct diagram |
| `TileDetail.tsx` | Full molecular detail for a single tile |
| `Recombinator.tsx` | Tile swapping, optimization strategies, genome-wide mode |
| `About.tsx` | Methodology, design decisions, paper references |
| `QCDashboard.tsx` | Quality control charts and statistics |
| `PresentationView.tsx` | Slide deck presentation mode |
| `Sidebar.tsx` | Navigation sidebar |

## Recombinator Features

### Optimization Strategies
- **ğŸŒˆ Max Diversity**: Maximize unique functional categories per group
- **ğŸ¯ Min Diversity**: Create functionally focused groups
- **ğŸ§¬ Pathway Focus**: Group tiles by KEGG metabolic pathway
- **âœ… Max GG-Ready**: Concentrate GG-ready tiles
- **âœ‚ï¸ Min BsaI**: Minimize internal BsaI burden
- **ğŸ² Random**: Random baseline
- **ğŸ“‹ Original**: Restore default arrangement

### Clonability Score (0â€“100)
Composite metric assuming all Lvl0s are domesticated:
- **Fragment Size Balance (40%)**: `1 âˆ’ CV(lengths)`, clamped [0,1]
- **GC Uniformity (30%)**: `1 âˆ’ mean(|GC âˆ’ 0.5| / 0.2)`, clamped [0,1]
- **Fragment Count (30%)**: `1 âˆ’ (filled âˆ’ 1) / 15`

Badge colors: â‰¥80 green, â‰¥60 yellow, <60 red.

### Category Exclusion Filter
Toggle panel to exclude categories from optimization scoring.
Default exclusions: Other, Uncharacterized, Unknown.

### Expandable Group Detail
Click genome-wide table rows to inspect tile composition:
source group, gene count, swap indicators, category tags.

## KEGG Pathway Data

Generated by `enrich_kegg_pathways.py`:
- Source: KEGG REST API (`eco` organism)
- 1658/4300 genes mapped to 128 specific pathways
- Broad overview pathways (eco01100, eco01110, etc.) excluded
- Stored as `pathways: string[]` in `gene_products.json`

## Design Decisions

1. **15 tiles/group**: Upper limit for reliable Golden Gate assembly
2. **Intergenic junctions**: 99.7% CDS-safe, operon-aware boundaries
3. **Standardized overhangs**: 16 positional overhangs, fully interchangeable tiles
4. **4-nt scars**: In intergenic regions, don't disrupt gene function
5. **Domestication-first**: All BsaI sites have pre-computed mutagenic primers
6. **Category keywords**: Product text â†’ 19 functional categories via keyword matching

## Regenerating Data

```bash
cd experiments/EXP_001
python3 pipeline_v2.py              # generates tile/primer CSVs
python3 generate_data_bundle.py     # outputs data_bundle_v2.json
python3 extract_gene_products.py    # outputs gene_products.json
python3 enrich_kegg_pathways.py     # enriches with KEGG pathways
```
